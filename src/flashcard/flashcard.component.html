<div class="relative">
  <!-- Alte Karte (Snapshot) fährt nach links raus -->
  <div *ngIf="cardPhase() !== 'idle'" class="absolute inset-0 z-0 transition-all duration-500 ease-in-out will-change-transform pointer-events-none"
       [class.translate-x-0]="cardPhase() === 'leaving'"
       [class.-translate-x-[200px]]="cardPhase() === 'entering'"
       [class.opacity-100]="cardPhase() === 'leaving'"
       [class.opacity-0]="cardPhase() === 'entering'">
    <div class="w-full h-full overflow-hidden">
      <div class="flex flex-row items-center justify-between w-full px-6 pt-4">
        <div *ngIf="oldMeta && oldMeta['category']" class="italic opacity-50">{{ oldMeta['category'] }}</div>
        <div class="flex items-center text-sm italic opacity-40">
          <mat-icon>swap_horiz</mat-icon>
          <span class="ml-2">Flip</span>
        </div>
      </div>
      <div>
        <div class="relative min-w-[360px] min-h-[160px] p-4 select-none">
          <!-- Old Front -->
          <div class="absolute inset-0 grid place-content-center gap-2 p-4 transition-opacity duration-300"
               [class.opacity-100]="!oldWasFlipped" [class.opacity-0]="oldWasFlipped">
            <div class="flex flex-row items-baseline">
              <div class="text-xl font-semibold">{{ oldFrontPrimary }}</div>
              <div class="text-base italic opacity-50 ml-2">{{ oldMeta['genus'] }}</div>
            </div>
            <div *ngIf="oldFrontExampleSentence">{{ oldFrontExampleSentence }}</div>
          </div>
          <!-- Old Back -->
            <div class="absolute inset-0 grid place-content-center gap-2 p-4 transition-opacity duration-300"
                 [class.opacity-0]="!oldWasFlipped" [class.opacity-100]="oldWasFlipped">
              <div class="text-xl font-semibold">{{ oldBackPrimary }}</div>
              <div *ngIf="oldBackExampleSentence">{{ oldBackExampleSentence }}</div>
            </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Aktuelle Karte (Enter via cardEnterPhase) -->
  <div class="relative overflow-hidden will-change-transform z-10"
            [class.translate-x-[200px]]="cardEnterPhase() === 'init'"
            [class.opacity-0]="cardEnterPhase() === 'init'"
            [class.translate-x-0]="cardEnterPhase() !== 'init'"
            [class.opacity-100]="cardEnterPhase() !== 'init'"
            [class.transition-none]="cardEnterPhase() === 'init'"
            [class.transition-all]="cardEnterPhase() === 'animating'"
            [class.duration-500]="cardEnterPhase() === 'animating'"
            [class.ease-in-out]="cardEnterPhase() === 'animating'"
            (mouseenter)="hoverOn()" (mouseleave)="hoverOff()"
            (click)="toggle(); $event.stopPropagation()">
    <div class="flex flex-row items-center justify-between w-full px-6 pt-4">
      <div *ngIf="meta && meta['category']" class="italic opacity-50">{{ meta['category'] }}</div>
      <div class="flex items-center text-sm italic opacity-50 transition-opacity duration-300"
           [class.opacity-100]="hovered()">
        <mat-icon>swap_horiz</mat-icon>
        <span class="ml-2">Flip</span>
      </div>
    </div>

    <div>
      <div class="relative min-w-[360px] min-h-[160px] p-4 cursor-pointer select-none">
        <!-- Front aktuell -->
        <div class="absolute inset-0 grid place-content-center gap-2 p-4 transition-opacity duration-300"
             [class.opacity-100]="!flipped()" [class.opacity-0]="flipped()" [class.pointer-events-none]="flipped()">
          <div class="flex flex-row items-baseline">
            <div class="text-xl font-semibold">{{ frontPrimary }}</div>
            <div class="text-base italic opacity-50 ml-2">{{ meta['genus'] }}</div>
          </div>
          <div *ngIf="frontExampleSentence">{{ frontExampleSentence }}</div>
        </div>
        <!-- Back aktuell -->
        <div class="absolute inset-0 grid place-content-center gap-2 p-4 transition-opacity duration-300"
             [class.opacity-0]="!flipped()" [class.opacity-100]="flipped()" [class.pointer-events-none]="!flipped()">
          <div class="text-xl font-semibold">{{ backPrimary }}</div>
          <div *ngIf="backExampleSentence">{{ backExampleSentence }}</div>
        </div>
      </div>
    </div>

    <div class="flex flex-row items-center justify-between w-full px-6 pb-4">
      <div class="relative flex items-center h-5 select-none text-sm opacity-60">
        <div class="flex items-center gap-1 transition-opacity duration-300"
             [class.opacity-100]="!flipped()" [class.opacity-0]="flipped()">
          <mat-icon class="leading-none align-middle">language</mat-icon>
          <span>{{ frontLang === 'fr' ? 'Französisch' : 'Deutsch' }}</span>
        </div>
        <div class="flex items-center gap-1 absolute left-0 transition-opacity duration-300"
             [class.opacity-0]="!flipped()" [class.opacity-100]="flipped()">
          <mat-icon class="leading-none align-middle">language</mat-icon>
          <span>{{ backLang === 'fr' ? 'Französisch' : 'Deutsch' }}</span>
        </div>
      </div>
    </div>
  </div>
</div>
